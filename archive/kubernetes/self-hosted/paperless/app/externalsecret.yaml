---
# yaml-language-server: $schema=https://kubernetes-schema.pages.dev/external-secrets.io/externalsecret_v1.json
apiVersion: external-secrets.io/v1
kind: ExternalSecret
metadata:
  name: paperless
spec:
  secretStoreRef:
    kind: ClusterSecretStore
    name: onepassword
  target:
    name: paperless-secret
    template:
      data:
        PAPERLESS_ADMIN_USER: "{{ .ADMIN_USER }}"
        PAPERLESS_ADMIN_PASSWORD: "{{ .ADMIN_PASSWORD }}"
        PAPERLESS_SECRET_KEY: "{{ .SECRET_KEY }}"
        PAPERLESS_SOCIALACCOUNT_PROVIDERS: |
          {"openid_connect":{"APPS":[{"provider_id":"pocketid","name":"PocketID","client_id":"{{ .OIDC_CLIENT_ID }}","secret":"{{ .OIDC_CLIENT_SECRET }}","settings":{"server_url":"https://id.achva.casa"}}],"OAUTH_PKCE_ENABLED":"True"}}
  dataFrom:
    - extract:
        key: paperless
