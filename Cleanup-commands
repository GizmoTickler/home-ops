#cleanup completed pods
kubectl get pods --all-namespaces |grep -i completed|awk '{print "kubectl delete pod "$2" -n "$1}'|bash
#cleanup completed jobs
kubectl get jobs --all-namespaces | sed '1d' | awk '{ print $2, "--namespace", $1 }' | while read line; do kubectl delete jobs $line; done
#cleanup Github Actions Logs
OWNER="GizmoTickler"; REPO="home-ops"; PAGE=1; while true; do RUN_IDS=$(gh api "/repos/$OWNER/$REPO/actions/runs?per_page=100&page=$PAGE" --jq '.workflow_runs[].id'); [ -z "$RUN_IDS" ] && break; echo "$RUN_IDS" | while read RUN_ID; do echo "Deleting run $RUN_ID"; gh api --method DELETE -H "Accept: application/vnd.github+json" -H "X-GitHub-Api-Version: 2022-11-28" "/repos/$OWNER/$REPO/actions/runs/$RUN_ID"; done; PAGE=$((PAGE+1)); done